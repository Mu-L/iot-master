{
  "title": "创建设备",
  "template": "form",
  "toolbar": [
    {
      "type": "button",
      "label": "选择产品ID",
      "action": {
        "type": "dialog",
        "page": "iot/product-choose",
        "after_close": "this.editor.patchValue({product_id: result.id})"
      }
    },
    {
      "type": "button",
      "label": "选择连接ID",
      "action": {
        "type": "dialog",
        "page": "iot/link-choose",
        "after_close": "this.editor.patchValue({link_id: result.id})"
      }
    }
  ],
  "fields": [
    {
      "key": "id",
      "label": "ID",
      "type": "text",
      "placeholder": "默认随机ID"
    },
    {
      "key": "name",
      "label": "名称",
      "type": "text"
    },
    {
      "key": "description",
      "label": "说明",
      "type": "text"
    },
    {
      "key": "product_id",
      "label": "产品ID",
      "type": "text",
      "change_action": {
        "type": "script",
        "script": "setTimeout(()=>this.load_product(), 100)"
      }
    },
    {
      "key": "link_id",
      "label": "连接ID",
      "type": "text"
    },
    {
      "key": "disabled",
      "label": "禁用",
      "type": "switch"
    }
  ],
  "submit_api": "table/device/create",
  "submit_success": "this.navigate('/page/iot/device-detail?id='+data)",
  "mount": "this.data.product_id=this.params.product_id; this.get_extend_fields()",
  "methods": {
    "get_extend_fields": "this.request.get('iot/device/extend/fields').subscribe(res=>{if(res.error)return; res.data.map(f=>this.content.fields.push(f) })"
   }
}